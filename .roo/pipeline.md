# Пайплайн разработки

## Введение
Общий пайплайн разработки описывает последовательность этапов, через которые проходит задача от момента ее возникновения до выпуска готового продукта или функциональности. Следование этому пайплайну обеспечивает предсказуемость, качество и своевременную доставку.

**Примечание:** Для крупных или специфичных проектов (например, "Step Flow") данный пайплайн может быть детализирован и адаптирован в соответствующей проектной документации (см. [`step_flow_project_plan.md`](step_flow_project_plan.md) или его англоязычную версию).

## Этапы пайплайна

1.  **Постановка задачи и планирование**:
    *   Задача может исходить от пользователя, стейкхолдера или быть создана `ProjectManager` на основе анализа требований или обратной связи.
    *   Задача должна быть четко сформулирована, содержать описание ожидаемого результата, критерии приемки и, по возможности, бизнес-контекст.
    *   Ответственные: `ProjectManager`, `Architect`.
    *   **Подзадачи ProjectManager (Примеры из SCRUM-1, SCRUM-3):**
        *   `SCRUM-1`: Определить и создать Эпики в Jira.
        *   `SCRUM-1`: Определить и настроить Спринты в Jira.
        *   `SCRUM-1`: Определить и настроить типы Задач в Jira.
        *   `SCRUM-1`: Настроить workflow для задач в Jira.
        *   `SCRUM-3`: Проведение UX-исследований и анализ пользовательских сценариев.
        *   `SCRUM-3`: Итеративное улучшение UI/UX на основе обратной связи и тестирования.
    *   **Подзадачи Ask (Примеры из LEARNJIRA-1, LEARNJIRA-2, LEARNJIRA-3):**
        *   `LEARNJIRA-3`: Изучить возможности Atlassian Intelligence для Jira.
        *   `LEARNJIRA-2`: Изучить функционал Plans (Advanced Roadmaps) в Jira.
        *   `LEARNJIRA-1`: Изучить управление безопасностью и правами доступа в Jira.

2.  **Анализ, проектирование и декомпозиция задачи**:
    *   Ответственные: `Architect`, `ProjectManager`, `Orchestrator`, `SF-UI-Designer`.
    *   На этом этапе задача анализируется на предмет технической реализуемости, влияния на существующую систему, необходимых ресурсов.
    *   Крупные задачи декомпозируются на более мелкие, управляемые подзадачи.
    *   Определяются зависимости между задачами.
    *   `Architect` предлагает высокоуровневое техническое решение, проектирует архитектуру, API, модели данных.
    *   **Подзадачи Architect (Примеры из SCRUM-20, SCRUM-12, SCRUM-11, SCRUM-10, SCRUM-8, SCRUM-5, SCRUM-3, SCRUM-2):**
        *   `SCRUM-20`: Создать и заполнить файл конфигурации SF-architect.json.
        *   `SCRUM-20`: Создать и заполнить файл конфигурации SF-project_manager.json.
        *   `SCRUM-20`: Создать и заполнить файл конфигурации SF-orchestrator.json.
        *   `SCRUM-20`: Создать и заполнить файл конфигурации SF-developer_backend.json.
        *   `SCRUM-20`: Создать и заполнить файл конфигурации SF-developer_frontend_web.json.
        *   `SCRUM-20`: Создать и заполнить файл конфигурации SF-qa.json.
        *   `SCRUM-20`: Создать и заполнить файл конфигурации SF-devops.json.
        *   `SCRUM-12`: Инициализировать Git-репозиторий и структурировать проект.
        *   `SCRUM-12`: Настроить CI/CD пайплайн для бэкенда (GitHub Actions).
        *   `SCRUM-12`: Настроить CI/CD пайплайн для фронтенда (GitHub Actions).
        *   `SCRUM-11`: Разработать концепцию и дизайн прелоадера.
        *   `SCRUM-10`: Спроектировать модель ролей и прав доступа.
        *   `SCRUM-8`: Проанализировать требования и определить состав основного API.
        *   `SCRUM-8`: Спроектировать эндпоинты для аутентификации и управления пользователями.
        *   `SCRUM-8`: Спроектировать эндпоинты для управления Workflow.
        *   `SCRUM-8`: Спроектировать эндпоинты для голосового управления.
        *   `SCRUM-8`: Спроектировать эндпоинты для конфигурации агентов (если необходимо).
        *   `SCRUM-8`: Создать спецификацию OpenAPI для основного API.
        *   `SCRUM-5`: Декомпозиция и планирование задач по настройке инфраструктуры.
        *   `SCRUM-5`: Декомпозиция и планирование задач по CI/CD.
        *   `SCRUM-5`: Декомпозиция и планирование задач по мониторингу и логированию.
        *   `SCRUM-5`: Декомпозиция и планирование задач по безопасности инфраструктуры.
        *   `SCRUM-3`: Разработка детальных макетов и прототипов интерфейса.
        *   `SCRUM-3`: Разработка и поддержка UI-кита и гайдлайнов по стилю.
        *   `SCRUM-2`: Декомпозиция и планирование разработки модуля управления Workflow.
        *   `SCRUM-2`: Декомпозиция и планирование разработки модуля аутентификации и управления пользователями.
        *   `SCRUM-2`: Декомпозиция и планирование разработки модуля голосового управления.
        *   `SCRUM-2`: Декомпозиция и планирование разработки конфигурации ИИ-агентов.

*   **Подзадачи SF-UI-Designer:**
        *   Разработка и поддержка UI-кита и гайдлайнов по стилю в соответствии с [`step_flow/.roo/roocode_rules.yaml`](./step_flow/.roo/roocode_rules.yaml).
        *   Ревью всех UI/UX решений на соответствие гайдлайнам.
3.  **Разработка**:
    *   Ответственные: `Code`.
    *   `Code` агент берет задачу или подзадачу из бэклога.
    *   Происходит написание кода, реализующего требуемую функциональность.
    *   Параллельно пишутся unit-тесты для нового кода.
    *   Разработчик следует гайдлайнам по контролю версий (создание ветки, семантические коммиты).
    *   **Подзадачи Code (Примеры из SCRUM-22, SCRUM-19, SCRUM-18, SCRUM-17, SCRUM-16, SCRUM-15, SCRUM-14, SCRUM-13, SCRUM-12, SCRUM-11, SCRUM-10, SCRUM-9, SCRUM-7, SCRUM-6):**
        *   `SCRUM-22`: Написать unit-тесты для модуля аутентификации.
        *   `SCRUM-19`: Выбрать и интегрировать фреймворк для MAS (Langchain/Autogen).
        *   `SCRUM-19`: Реализовать логику загрузки определения workflow из PostgreSQL.
        *   `SCRUM-19`: Реализовать интерпретацию простого workflow.
        *   `SCRUM-19`: Создать 2-3 простых агента-заглушки.
        *   `SCRUM-19`: Реализовать механизм передачи данных между агентами-заглушками.
        *   `SCRUM-19`: Реализовать API эндпоинт для запуска workflow.
        *   `SCRUM-19`: Реализовать логирование хода выполнения workflow.
        *   `SCRUM-19`: Написать unit-тесты для ядра MAS.
        *   `SCRUM-18`: Интегрировать библиотеку react-flow.
        *   `SCRUM-18`: Реализовать панель с типами узлов.
        *   `SCRUM-18`: Реализовать перетаскивание узлов на холст.
        *   `SCRUM-18`: Реализовать соединение узлов.
        *   `SCRUM-18`: Реализовать сохранение workflow.
        *   `SCRUM-18`: Реализовать загрузку существующего workflow (Опционально для MVP).
        *   `SCRUM-18`: Реализовать базовую стилизацию узлов и холста.
        *   `SCRUM-17`: Реализовать API эндпоинт для приема аудио.
        *   `SCRUM-17`: Настроить интеграцию с API OpenAI Whisper.
        *   `SCRUM-17`: Настроить интеграцию с API ElevenLabs.
        *   `SCRUM-17`: Реализовать логику обработки простой команды.
        *   `SCRUM-17`: Реализовать генерацию простого голосового ответа.
        *   `SCRUM-17`: Обеспечить обработку ошибок от внешних API.
        *   `SCRUM-17`: Написать unit-тесты для сервиса диалога.
        *   `SCRUM-16`: Определить структуру данных для workflow.
        *   `SCRUM-16`: Реализовать API эндпоинт для создания workflow (POST /workflows).
        *   `SCRUM-16`: Реализовать API эндпоинт для получения списка workflow (GET /workflows).
        *   `SCRUM-16`: Реализовать API эндпоинт для получения workflow по ID (GET /workflows/{workflow_id}).
        *   `SCRUM-16`: Реализовать API эндпоинт для обновления workflow (PUT /workflows/{workflow_id}) (Опционально для MVP).
        *   `SCRUM-16`: Реализовать API эндпоинт для удаления workflow (DELETE /workflows/{workflow_id}) (Опционально для MVP).
        *   `SCRUM-16`: Обеспечить защиту API.
        *   `SCRUM-16`: Написать unit-тесты для API управления workflow.
        *   `SCRUM-16`: Сгенерировать документацию API (OpenAPI).
        *   `SCRUM-15`: Создать React-компонент для главного дашборда.
        *   `SCRUM-15`: Реализовать базовую разметку страницы дашборда.
        *   `SCRUM-15`: Обеспечить доступ только аутентифицированным пользователям.
        *   `SCRUM-15`: Применить начальную стилизацию в неоморфном дизайне.
        *   `SCRUM-15`: Подготовить плейсхолдеры для будущих разделов.
        *   `SCRUM-14`: Создать React-компоненты для страниц регистрации и входа.
        *   `SCRUM-14`: Реализовать взаимодействие с API аутентификации бэкенда.
        *   `SCRUM-14`: Реализовать сохранение JWT-токенов.
        *   `SCRUM-14`: Реализовать управление состоянием аутентификации.
        *   `SCRUM-14`: Реализовать переадресацию после успешного входа/регистрации.
        *   `SCRUM-14`: Реализовать функцию выхода пользователя.
        *   `SCRUM-14`: Реализовать отображение ошибок аутентификации.
        *   `SCRUM-14`: Написать unit-тесты для компонентов и логики аутентификации.
        *   `SCRUM-13`: Реализовать API эндпоинт /auth/register.
        *   `SCRUM-13`: Реализовать API эндпоинт /auth/login.
        *   `SCRUM-13`: Реализовать API эндпоинт /auth/logout.
        *   `SCRUM-13`: Реализовать API эндпоинт /auth/refresh_token.
        *   `SCRUM-13`: Настроить хранение данных пользователей в PostgreSQL.
        *   `SCRUM-13`: Обеспечить защиту API аутентификации.
        *   `SCRUM-13`: Написать unit-тесты для сервиса аутентификации.
        *   `SCRUM-13`: Сгенерировать документацию API для аутентификации (OpenAPI).
        *   `SCRUM-12`: Создать базовый Dockerfile для бэкенда.
        *   `SCRUM-12`: Создать базовый Dockerfile для фронтенда.
        *   `SCRUM-11`: Создать SVG-графику для прелоадера.
        *   `SCRUM-11`: Реализовать анимацию прелоадера с использованием GSAP.
        *   `SCRUM-11`: Интегрировать прелоадер в index.html и протестировать.
        *   `SCRUM-10`: Реализовать механизм хранения ролей и прав в БД.
        *   `SCRUM-10`: Реализовать API для управления ролями и правами.
        *   `SCRUM-10`: Интегрировать проверку прав доступа в существующие API.
        *   `SCRUM-10`: Написать unit-тесты для системы ролей и прав.
        *   `SCRUM-9`: Написать unit-тесты для модуля аутентификации (повтор SCRUM-22).
        *   `SCRUM-7`: Реализовать эндпоинт для создания пользователя (POST /users).
        *   `SCRUM-7`: Реализовать эндпоинт для получения списка пользователей (GET /users).
        *   `SCRUM-7`: Реализовать эндпоинт для получения пользователя по ID (GET /users/{user_id}).
        *   `SCRUM-7`: Реализовать эндпоинт для обновления пользователя (PUT /users/{user_id}).
        *   `SCRUM-7`: Реализовать эндпоинт для удаления пользователя (DELETE /users/{user_id}).
        *   `SCRUM-7`: Интегрировать с системой ролей и прав (SCRUM-10).
        *   `SCRUM-7`: Написать unit-тесты для API управления пользователями.
        *   `SCRUM-6`: Бэкенд: Реализовать API аутентификации (см. SCRUM-13).
        *   `SCRUM-6`: Фронтенд: Реализовать UI и логику аутентификации (см. SCRUM-14).

4.  **Тестирование**:
    *   Ответственные: `QA`, `Code` (для unit-тестов).
    *   После завершения разработки `Code` агентом, функциональность передается на тестирование `QA` агенту.
    *   `QA` агент выполняет тест-кейсы (ручные или автоматизированные), проводит регрессионное тестирование.
    *   Все найденные баги регистрируются в таск-трекере и передаются `Code` агенту на исправление.
    *   Цикл "Разработка (исправление багов) -> Тестирование" может повторяться несколько раз.
    *   **Подзадачи QA (Примеры из SCRUM-21, SCRUM-12, SCRUM-4):**
        *   `SCRUM-21`: Создать документ с планом тестирования MVP.
        *   `SCRUM-21`: Подготовить базовые тест-кейсы для ручного тестирования аутентификации.
        *   `SCRUM-21`: Подготовить базовые тест-кейсы для ручного тестирования API управления workflow.
        *   `SCRUM-21`: Подготовить базовые тест-кейсы для ручного тестирования UI конструктора workflow.
        *   `SCRUM-21`: Настроить проект для UI-автоматизации (Cypress/Selenium).
        *   `SCRUM-21`: Настроить систему для баг-трекинга.
        *   `SCRUM-12`: Проверить работу CI/CD на тестовых коммитах.
        *   `SCRUM-4`: Разработка стратегии тестирования.
        *   `SCRUM-4`: Планирование и написание тест-кейсов для расширенного функционала.
        *   `SCRUM-4`: Настройка и развитие автоматизированного тестирования.
        *   `SCRUM-4`: Организация процесса регрессионного тестирования.

*   Проверка соответствия UI/UX утвержденным гайдлайнам ([`step_flow/.roo/roocode_rules.yaml`](./step_flow/.roo/roocode_rules.yaml)).
5.  **Ревью кода**:
    *   Ответственные: другие `Code` агенты, `Architect`.
    *   После того как код написан и прошел предварительное тестирование (unit-тесты), создается Pull Request (PR) или Merge Request (MR).
    *   Код ревьюится на предмет соответствия стандартам, качества, отсутствия потенциальных проблем и архитектурной целостности.
    *   Замечания обсуждаются и исправляются автором кода.

6.  **Мерж в основную ветку разработки**:
    *   После успешного ревью и прохождения всех CI-проверок (линтеры, тесты, сборка), код из ветки фичи/багфикса мёржится в основную ветку разработки (например, `develop` или `main`).
    *   Предпочтительно использовать squash-merge для чистоты истории, если это принято в проекте.

7.  **(Если применимо) Сборка и деплой на тестовые/стейджинг окружения**:
    *   После мержа в основную ветку, запускается процесс CI/CD для сборки артефактов и их деплоя на тестовые или стейджинг окружения.
    *   На этих окружениях может проводиться дополнительное приемочное тестирование (UAT) или демонстрация заказчику/пользователю.

8.  **(Если применимо) Релиз**:
    *   После успешного тестирования на промежуточных окружениях и получения одобрения, планируется и выполняется релиз на продакшн-окружение.
    *   Это может включать подготовку релиз-ноутов, оповещение пользователей.

9.  **Мониторинг и сбор обратной связи**:
    *   После релиза важно отслеживать работу системы, собирать логи, метрики производительности.
    *   Собирается обратная связь от пользователей для выявления проблем или потенциальных улучшений.
    *   Эта информация используется для создания новых задач или улучшения существующих процессов.

## Инструменты
Для эффективной работы пайплайна используются различные инструменты:
*   **Таск-трекеры**: Jira, Trello, Asana, YouTrack (или внутренняя система управления задачами). Используются для создания, отслеживания и управления задачами. **ВАЖНО: В проекте "Step Flow" ВСЕ задачи (создание, описание, распределение ролей, отслеживание прогресса, документирование и т.д.) ВЕДУТСЯ ИСКЛЮЧИТЕЛЬНО в JIRA.**
*   **Системы контроля версий**: Git (с хостингами GitHub, GitLab, Bitbucket).
*   **CI/CD**: Jenkins, GitLab CI, GitHub Actions, CircleCI, TeamCity. Для автоматизации сборки, тестирования и деплоя.
*   **Инструменты для коммуникации**: Slack, Microsoft Teams, Mattermost. Для обсуждений и уведомлений.
*   **Инструменты для документирования**: Confluence, Notion, MkDocs, Sphinx. Для ведения технической и пользовательской документации.
*   **Мониторинг и логирование**: Prometheus, Grafana, ELK Stack (Elasticsearch, Logstash, Kibana), Sentry, Datadog.

Выбор конкретных инструментов зависит от проекта и команды. Важно, чтобы все участники процесса умели ими пользоваться и следовали установленным правилам их использования.